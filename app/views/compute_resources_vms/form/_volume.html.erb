<div class="fields">
  <%
     selected = ""
     size = ""
     if params['host']
         if new.__vbds
	     selected = new.__vbds['print']
	     size     = new.__vbds['physical_size']
	 elsif params && params['host'] && params['host']['compute_attributes'] && params['host']['compute_attributes']['VBDs']['physical_size'] != ""
	     selected = params['host']['compute_attributes']['VBDs']['print']
	     size     = params['host']['compute_attributes']['VBDs']['physical_size']
	 end
      elsif params['controller'] == 'hosts' and params['action'] == 'edit'
             ## edit hosts
             d = new.vbds[0].vdi
             selected = d.sr.name
             size = d.virtual_size.to_i / (1024 * 1024 * 1024)
      elsif params['controller'] == 'compute_attributes'
            selected = new.__vbds['print']
            size     = new.__vbds['physical_size']
      end
  -%>
  <%= selectable_f f, :print, compute_resource.storage_pools.map(&:name), { :selected => selected }, :class => "span2", :label => _("Storage Repository") %>
  <%= text_f f, :physical_size, :class => "input-mini", :label => _("Size (GB)"), :value => size %>
</div>
